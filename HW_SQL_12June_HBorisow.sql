-- 1 уровень сложности: Работа с датой и временем. Используя БД SHOP:
-- Определить, сколько покупок было совершено в каждый месяц. 
-- Отсортировать строки в порядке возрастания количества покупок. Вывести два поля - номер месяца и количество покупок
-- Определить, в какой месяц было совершено больше всего покупок.  Вывести два поля - номер месяца и количество покупок

-- Используем функцию агрегации COUNT(), функцию извлечения месяца MONTH() и функцию группировки GROUP BY. 
-- Определить количество покупок в каждый месяц и отсортировать строки по возрастанию количества покупок:

SELECT MONTH(ODATE) AS month_number, COUNT(*) AS purchase_count
FROM orders
GROUP BY month_number
ORDER BY purchase_count ASC;

-- Определить месяц с наибольшим количеством покупок:

SELECT MONTH(ODATE) AS month_number, COUNT(*) AS purchase_count
FROM orders
GROUP BY month_number
ORDER BY purchase_count DESC
LIMIT 1;
-- Первый запрос выводит все месяцы с количеством покупок, отсортированными по возрастанию. 
-- Второй запрос выведет месяц с наибольшим количеством покупок в порядке убывания.

-- ============

-- Используя БД hr:
-- Найти среднюю зарплату по компании
-- Найти общее количество департаментов
-- Найти количество департаментов, в которых никто не работает
-- Найти среднюю зарплату в департаменте с id 90
-- Найти самую большую зарплату среди сотрудников, работающих в департаментах с id 70 и 80

-- Используем функцию агрегации AVG() для расчета средней зарплаты, 
-- функцию COUNT() для подсчета количества департаментов, 
-- функцию JOIN для объединения таблиц, 
-- и операторы WHERE и GROUP BY для фильтрации и группировки данных. 

-- Найти среднюю зарплату по компании:

SELECT AVG(salary) AS average_salary
FROM employees;

-- Найти общее количество департаментов:

SELECT COUNT(*) AS total_departments
FROM departments;
 
-- Найти количество департаментов, в которых никто не работает:

SELECT COUNT(*) AS empty_departments
FROM departments
WHERE department_id NOT IN (SELECT DISTINCT department_id FROM employees);
 
-- Найти среднюю зарплату в департаменте с id 90:

SELECT AVG(salary) AS average_salary
FROM employees
WHERE department_id = 90;

-- Найти самую большую зарплату среди сотрудников, работающих в департаментах с id 70 и 80:

SELECT MAX(salary) AS max_salary
FROM employees
WHERE department_id IN (70, 80);



